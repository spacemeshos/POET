syntax = "proto3";

import "google/api/annotations.proto";

package api;

service Poet {
    rpc Submit (SubmitRequest) returns (SubmitResponse) {
        option (google.api.http) = {
            post: "/v1/submit",
            body: "*",
        };
    }

    rpc GetInfo (GetInfoRequest) returns (GetInfoResponse) {
        option (google.api.http) = {
            get: "/v1/info"
        };
    }
}

message SubmitRequest {
    bytes challenge = 1;
}

message SubmitResponse {
    int32 roundId = 1;
    bytes poetId = 2; // TODO: remove this once we have persistent PoET identities that the node knows in advance
}

message GetInfoRequest {
}

message GetInfoResponse {
    int32 openRoundId = 1;
    repeated int32 executingRoundsIds = 2;
}

message MembershipProof {
    int32 index = 1;
    bytes root = 2;
    repeated bytes proof = 3;
}

message PoetProof {
    bytes phi = 1;
    repeated bytes provenLeaves = 2;
    repeated bytes proofNodes = 3;
}
